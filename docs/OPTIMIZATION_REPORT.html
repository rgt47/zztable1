<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Deep Dive Code Review: zztable1_nextgen Optimization Report • zztable1nextgen</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><meta property="og:title" content="Deep Dive Code Review: zztable1_nextgen Optimization Report"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">zztable1nextgen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/zztable1_nextgen_guide.html">zztable1_nextgen: Advanced Publication-Ready Summary Tables</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Deep Dive Code Review: zztable1_nextgen Optimization Report</h1>
    </div>

<div id="deep-dive-code-review-zztable1_nextgen-optimization-report" class="section level1">

<div class="section level2">
<h2 id="executive-summary">Executive Summary<a class="anchor" aria-label="anchor" href="#executive-summary"></a></h2>
<p>The zztable1_nextgen codebase shows innovative architecture with lazy evaluation blueprints, but requires significant optimization to meet modern R development standards. This report identifies critical improvements across 8 areas with specific recommendations and implementation examples.</p>
<p><strong>Current State:</strong> - 1,591 lines in single file - 91.9% test pass rate - Monolithic architecture - Memory inefficient storage - Limited error handling</p>
<p><strong>Optimization Priorities:</strong> 1. <strong>Critical</strong>: Memory optimization, modular architecture 2. <strong>High</strong>: Error handling, input validation 3. <strong>Medium</strong>: Performance improvements, code simplification 4. <strong>Low</strong>: Documentation consistency, modern R patterns</p>
<hr></div>
<div class="section level2">
<h2 id="id_1-critical-memory-and-storage-improvements">1. Critical Memory and Storage Improvements<a class="anchor" aria-label="anchor" href="#id_1-critical-memory-and-storage-improvements"></a></h2>
<div class="section level3">
<h3 id="issue-inefficient-blueprint-storage">Issue: Inefficient Blueprint Storage<a class="anchor" aria-label="anchor" href="#issue-inefficient-blueprint-storage"></a></h3>
<p><strong>Current Problem (Line 194):</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cells</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nrows</span> <span class="op">*</span> <span class="va">ncols</span><span class="op">)</span>  <span class="co"># Creates nrows*ncols empty list elements</span></span></code></pre></div>
<p>For a 20x5 table: 100 list elements created upfront, most never used.</p>
<p><strong>Optimized Solution:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Optimized Blueprint with Sparse Storage</span></span>
<span><span class="va">Table1Blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nrows</span>, <span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="co"># Use environment for sparse hash-table storage</span></span>
<span>      cells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>hash <span class="op">=</span> <span class="cn">TRUE</span>, parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span>,</span>
<span>      ncols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span>,</span>
<span>      row_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span>,</span>
<span>      col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span>,</span>
<span>      metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        data_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        cell_count <span class="op">=</span> <span class="fl">0L</span>  <span class="co"># Track actual cells stored</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    class <span class="op">=</span> <span class="st">"table1_blueprint"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Optimized indexing with lazy allocation</span></span>
<span><span class="va">`[.table1_blueprint`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">drop</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Both row and column indices required"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Bounds checking</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">||</span> <span class="va">i</span> <span class="op">&gt;</span> <span class="va">x</span><span class="op">$</span><span class="va">nrows</span> <span class="op">||</span> <span class="va">j</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">||</span> <span class="va">j</span> <span class="op">&gt;</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Index out of bounds: ["</span>, <span class="va">i</span>, <span class="st">","</span>, <span class="va">j</span>, <span class="st">"] for "</span>, </span>
<span>         <span class="va">x</span><span class="op">$</span><span class="va">nrows</span>, <span class="st">"x"</span>, <span class="va">x</span><span class="op">$</span><span class="va">ncols</span>, <span class="st">" table"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_"</span>, <span class="va">j</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="va">key</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span>, inherits <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">key</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span>, inherits <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">`[&lt;-.table1_blueprint`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Both row and column indices required"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Bounds checking</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">||</span> <span class="va">i</span> <span class="op">&gt;</span> <span class="va">x</span><span class="op">$</span><span class="va">nrows</span> <span class="op">||</span> <span class="va">j</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">||</span> <span class="va">j</span> <span class="op">&gt;</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Index out of bounds"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_"</span>, <span class="va">j</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">key</span>, <span class="va">value</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span><span class="op">)</span></span>
<span>    <span class="co"># Update cell count if new</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="va">key</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_count</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_count</span> <span class="op">+</span> <span class="fl">1L</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Remove cell</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="va">key</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span>, inherits <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">key</span>, envir <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">cells</span><span class="op">)</span></span>
<span>      <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_count</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_count</span> <span class="op">-</span> <span class="fl">1L</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Memory Benefits:</strong> - <strong>Before</strong>: O(nrows × ncols) memory regardless of actual content - <strong>After</strong>: O(actual_cells) memory with hash table lookup - <strong>Typical savings</strong>: 70-90% memory reduction for sparse tables</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_2-function-decomposition-and-modularity">2. Function Decomposition and Modularity<a class="anchor" aria-label="anchor" href="#id_2-function-decomposition-and-modularity"></a></h2>
<div class="section level3">
<h3 id="issue-monolithic-analyze_table_dimensions-function">Issue: Monolithic analyze_table_dimensions Function<a class="anchor" aria-label="anchor" href="#issue-monolithic-analyze_table_dimensions-function"></a></h3>
<p><strong>Current Problem:</strong> - 322 lines (Lines 558-880) - Handles 6 different concerns - Difficult to test and maintain</p>
<p><strong>Optimized Solution:</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Modular Dimension Analysis</span></span>
<span><span class="va">analyze_table_dimensions</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x_vars</span>, <span class="va">grp_var</span>, <span class="va">data</span>, <span class="va">strata</span>, </span>
<span>                                   <span class="va">missing</span>, <span class="va">size</span>, <span class="va">totals</span>, <span class="va">pvalue</span>, </span>
<span>                                   <span class="va">layout</span> <span class="op">=</span> <span class="st">"console"</span>, <span class="va">footnotes</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Validate inputs first</span></span>
<span>  <span class="fu">validate_dimension_inputs</span><span class="op">(</span><span class="va">x_vars</span>, <span class="va">grp_var</span>, <span class="va">data</span>, <span class="va">strata</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Break into focused functions</span></span>
<span>  <span class="va">var_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_variables</span><span class="op">(</span><span class="va">x_vars</span>, <span class="va">data</span>, <span class="va">missing</span><span class="op">)</span></span>
<span>  <span class="va">group_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_groups</span><span class="op">(</span><span class="va">grp_var</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">strata_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_strata</span><span class="op">(</span><span class="va">strata</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">column_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_columns</span><span class="op">(</span><span class="va">group_analysis</span>, <span class="va">totals</span>, <span class="va">pvalue</span><span class="op">)</span></span>
<span>  <span class="va">row_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_rows</span><span class="op">(</span><span class="va">var_analysis</span>, <span class="va">strata_analysis</span>, <span class="va">size</span><span class="op">)</span></span>
<span>  <span class="va">footnote_analysis</span> <span class="op">&lt;-</span> <span class="fu">analyze_footnotes</span><span class="op">(</span><span class="va">footnotes</span>, <span class="va">var_analysis</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Combine results</span></span>
<span>  <span class="fu">combine_dimension_analysis</span><span class="op">(</span></span>
<span>    variables <span class="op">=</span> <span class="va">var_analysis</span>,</span>
<span>    groups <span class="op">=</span> <span class="va">group_analysis</span>,</span>
<span>    strata <span class="op">=</span> <span class="va">strata_analysis</span>,</span>
<span>    columns <span class="op">=</span> <span class="va">column_analysis</span>,</span>
<span>    rows <span class="op">=</span> <span class="va">row_analysis</span>,</span>
<span>    footnotes <span class="op">=</span> <span class="va">footnote_analysis</span>,</span>
<span>    layout <span class="op">=</span> <span class="va">layout</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Focused Variable Analysis</span></span>
<span><span class="va">analyze_variables</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x_vars</span>, <span class="va">data</span>, <span class="va">missing</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">var_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_vars</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">var_info</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x_vars</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">var</span> <span class="kw">in</span> <span class="va">x_vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Use match/switch for better performance than if/else chains</span></span>
<span>    <span class="va">var_type</span> <span class="op">&lt;-</span> <span class="fu">determine_variable_type</span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">var_info</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">var_type</span>,</span>
<span>      <span class="st">"factor"</span> <span class="op">=</span> <span class="fu">analyze_factor_variable</span><span class="op">(</span><span class="va">var_data</span>, <span class="va">missing</span><span class="op">)</span>,</span>
<span>      <span class="st">"numeric"</span> <span class="op">=</span> <span class="fu">analyze_numeric_variable</span><span class="op">(</span><span class="va">var_data</span>, <span class="va">missing</span><span class="op">)</span>,</span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Unsupported variable type: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">var_info</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="va">var</span></span>
<span>    <span class="va">var_info</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="va">var_type</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">var_info</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Efficient Variable Type Determination</span></span>
<span><span class="va">determine_variable_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"factor"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"numeric"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"unknown"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Benefits:</strong> - <strong>Testability</strong>: Each function can be unit tested independently - <strong>Maintainability</strong>: Single responsibility per function - <strong>Reusability</strong>: Functions can be reused in different contexts - <strong>Performance</strong>: Eliminates redundant computations</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_3-enhanced-error-handling-and-validation">3. Enhanced Error Handling and Validation<a class="anchor" aria-label="anchor" href="#id_3-enhanced-error-handling-and-validation"></a></h2>
<div class="section level3">
<h3 id="issue-insufficient-input-validation">Issue: Insufficient Input Validation<a class="anchor" aria-label="anchor" href="#issue-insufficient-input-validation"></a></h3>
<p><strong>Current Problem:</strong> - Limited validation in main functions - Silent failures in cell evaluation - Poor error messages</p>
<p><strong>Optimized Solution:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Comprehensive Input Validation</span></span>
<span><span class="va">validate_table1_inputs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">strata</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Formula validation</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">formula</span>, <span class="st">"formula"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"First argument must be a formula object"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Formula must have at least a response term"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Data validation</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">is.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'data' must be a data.frame"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Data contains no rows"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Variable existence check</span></span>
<span>  <span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html" class="external-link">all.vars</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span></span>
<span>  <span class="va">missing_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">vars</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">missing_vars</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Variables not found in data: "</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">missing_vars</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Strata validation</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'strata' must be a single character string"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">strata</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Strata variable '"</span>, <span class="va">strata</span>, <span class="st">"' not found in data"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Type validation with warnings for potential issues</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">var</span> <span class="kw">in</span> <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="va">var</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Variable '"</span>, <span class="va">var</span>, <span class="st">"' contains only missing values"</span>, </span>
<span>              call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Character variable '"</span>, <span class="va">var</span>, <span class="st">"' has many levels ("</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">)</span>, <span class="st">"), consider converting to factor"</span>,</span>
<span>              call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Robust Cell Evaluation with Error Recovery</span></span>
<span><span class="va">evaluate_cell_safely</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cell</span>, <span class="va">data</span>, <span class="va">blueprint_metadata</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span> <span class="op">||</span> <span class="va">cell</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"static"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">content</span> <span class="op"><a href="reference/grapes-or-or-grapes.html">%||%</a></span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check cache first</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">cached_result</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">cached_result</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"computation"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="co"># Create safe evaluation environment</span></span>
<span>      <span class="va">eval_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>      <span class="va">data_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">data_subset</span>, <span class="va">eval_env</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Enhanced evaluation context with error handling</span></span>
<span>      <span class="va">comp_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">data_subset</span>,</span>
<span>        n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data_subset</span><span class="op">)</span>,</span>
<span>        na_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_subset</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Add theme-specific formatting if available</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">blueprint_metadata</span><span class="op">$</span><span class="va">theme</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">comp_env</span><span class="op">$</span><span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">blueprint_metadata</span><span class="op">$</span><span class="va">theme</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">computation</span>, <span class="va">comp_env</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Cell computation failed: "</span>, <span class="va">e</span><span class="op">$</span><span class="va">message</span>, </span>
<span>              <span class="st">"\n  Cell type: "</span>, <span class="va">cell</span><span class="op">$</span><span class="va">type</span>,</span>
<span>              <span class="st">"\n  Dependencies: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">dependencies</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>,</span>
<span>              call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"[Error]"</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span>, warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Suppress common statistical warnings but preserve the result</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"NAs introduced|NAs produced"</span>, <span class="va">w</span><span class="op">$</span><span class="va">message</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">invokeRestart</a></span><span class="op">(</span><span class="st">"muffleWarning"</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Cache successful results</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"[Error]"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">cell</span><span class="op">$</span><span class="va">cached_result</span> <span class="op">&lt;-</span> <span class="va">result</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Handle other cell types</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">cell</span><span class="op">$</span><span class="va">type</span>,</span>
<span>    <span class="st">"separator"</span> <span class="op">=</span> <span class="va">cell</span><span class="op">$</span><span class="va">content</span> <span class="op"><a href="reference/grapes-or-or-grapes.html">%||%</a></span> <span class="st">"|"</span>,</span>
<span>    <span class="st">"footnote"</span> <span class="op">=</span> <span class="fu">format_footnote</span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="st">"footnote_separator"</span> <span class="op">=</span> <span class="va">cell</span><span class="op">$</span><span class="va">content</span> <span class="op"><a href="reference/grapes-or-or-grapes.html">%||%</a></span> <span class="st">"---"</span>,</span>
<span>    <span class="st">""</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Safe operator for NULL values</span></span>
<span><span class="va">`%||%`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="va">y</span> <span class="kw">else</span> <span class="va">x</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_4-performance-optimization">4. Performance Optimization<a class="anchor" aria-label="anchor" href="#id_4-performance-optimization"></a></h2>
<div class="section level3">
<h3 id="issue-inefficient-cell-evaluation-loop">Issue: Inefficient Cell Evaluation Loop<a class="anchor" aria-label="anchor" href="#issue-inefficient-cell-evaluation-loop"></a></h3>
<p><strong>Current Problem (Lines 1432-1437):</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">x</span><span class="op">$</span><span class="va">nrows</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cell</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">result_df</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">evaluate_cell</span><span class="op">(</span><span class="va">cell</span>, <span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimized Solution:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Vectorized Data Frame Conversion</span></span>
<span><span class="va">as.data.frame.table1_blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">data</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                         <span class="va">parallel</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Data must be provided for blueprint evaluation"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Pre-allocate result matrix with appropriate type</span></span>
<span>  <span class="va">result_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">""</span>, nrow <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">nrows</span>, ncol <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Get all non-NULL cells efficiently</span></span>
<span>  <span class="va">cell_positions</span> <span class="op">&lt;-</span> <span class="fu">get_populated_cells</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_positions</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Empty table</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result_matrix</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">col_names</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">row_names</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Group cells by type for batch processing</span></span>
<span>  <span class="va">cell_groups</span> <span class="op">&lt;-</span> <span class="fu">group_cells_by_type</span><span class="op">(</span><span class="va">x</span>, <span class="va">cell_positions</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Process static cells (no computation needed)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_groups</span><span class="op">$</span><span class="va">static</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">pos</span> <span class="kw">in</span> <span class="va">cell_groups</span><span class="op">$</span><span class="va">static</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">result_matrix</span><span class="op">[</span><span class="va">pos</span><span class="op">$</span><span class="va">i</span>, <span class="va">pos</span><span class="op">$</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">pos</span><span class="op">$</span><span class="va">i</span>, <span class="va">pos</span><span class="op">$</span><span class="va">j</span><span class="op">]</span><span class="op">$</span><span class="va">content</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Process computation cells (potentially in parallel)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cell_groups</span><span class="op">$</span><span class="va">computation</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">parallel</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"parallel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Parallel evaluation for expensive computations</span></span>
<span>      <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="va">cell_groups</span><span class="op">$</span><span class="va">computation</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          i <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">i</span>, j <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">j</span>,</span>
<span>          result <span class="op">=</span> <span class="fu">evaluate_cell_safely</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">pos</span><span class="op">$</span><span class="va">i</span>, <span class="va">pos</span><span class="op">$</span><span class="va">j</span><span class="op">]</span>, <span class="va">data</span>, <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span>, mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Assign results back to matrix</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">res</span> <span class="kw">in</span> <span class="va">results</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">result_matrix</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">i</span>, <span class="va">res</span><span class="op">$</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">result</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="co"># Sequential evaluation with caching</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">pos</span> <span class="kw">in</span> <span class="va">cell_groups</span><span class="op">$</span><span class="va">computation</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">result_matrix</span><span class="op">[</span><span class="va">pos</span><span class="op">$</span><span class="va">i</span>, <span class="va">pos</span><span class="op">$</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span></span>
<span>          <span class="fu">evaluate_cell_safely</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">pos</span><span class="op">$</span><span class="va">i</span>, <span class="va">pos</span><span class="op">$</span><span class="va">j</span><span class="op">]</span>, <span class="va">data</span>, <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Convert to data.frame efficiently</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result_matrix</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Set names if available</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">col_names</span><span class="op">)</span> <span class="op">==</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">col_names</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">row_names</span><span class="op">)</span> <span class="op">==</span> <span class="va">x</span><span class="op">$</span><span class="va">nrows</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">row_names</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Get populated cell positions efficiently</span></span>
<span><span class="va">get_populated_cells</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">blueprint</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">blueprint</span><span class="op">$</span><span class="va">cells</span>, <span class="st">"environment"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># For environment-based storage</span></span>
<span>    <span class="va">keys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">blueprint</span><span class="op">$</span><span class="va">cells</span>, all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">keys</span>, <span class="kw">function</span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">key</span>, <span class="st">"_"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># For list-based storage (fallback)</span></span>
<span>    <span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">blueprint</span><span class="op">$</span><span class="va">nrows</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">blueprint</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">blueprint</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">positions</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span>, j <span class="op">=</span> <span class="va">j</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">positions</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Performance Benefits:</strong> - <strong>Eliminates redundant cell access</strong>: Direct position mapping - <strong>Batch processing</strong>: Groups similar operations - <strong>Parallel support</strong>: Optional parallel evaluation for large tables - <strong>Reduced memory allocation</strong>: Pre-allocated result matrix</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_5-modern-r-best-practices-implementation">5. Modern R Best Practices Implementation<a class="anchor" aria-label="anchor" href="#id_5-modern-r-best-practices-implementation"></a></h2>
<div class="section level3">
<h3 id="issue-ad-hoc-object-structure">Issue: Ad-hoc Object Structure<a class="anchor" aria-label="anchor" href="#issue-ad-hoc-object-structure"></a></h3>
<p><strong>Current Problem:</strong> - No proper S3 class validation - Limited method dispatch - No input validation in constructors</p>
<p><strong>Optimized Solution:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Modern S3 Class Implementation with Validation</span></span>
<span><span class="va">new_table1_blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nrows</span>, <span class="va">ncols</span>, </span>
<span>                               <span class="va">cells</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>hash <span class="op">=</span> <span class="cn">TRUE</span>, parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="va">row_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span>,</span>
<span>                               <span class="va">col_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span>,</span>
<span>                               <span class="va">metadata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Input validation</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">nrows</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">ncols</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">row_names</span><span class="op">)</span> <span class="op">==</span> <span class="va">nrows</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">col_names</span><span class="op">)</span> <span class="op">==</span> <span class="va">ncols</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      cells <span class="op">=</span> <span class="va">cells</span>,</span>
<span>      nrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span>,</span>
<span>      ncols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span>,</span>
<span>      row_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">row_names</span><span class="op">)</span>,</span>
<span>      col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">col_names</span><span class="op">)</span>,</span>
<span>      metadata <span class="op">=</span> <span class="va">metadata</span></span>
<span>    <span class="op">)</span>,</span>
<span>    class <span class="op">=</span> <span class="st">"table1_blueprint"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' User-facing constructor with validation</span></span>
<span><span class="va">Table1Blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nrows</span>, <span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span> <span class="op">||</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"nrows and ncols must be single numeric values"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">nrows</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">||</span> <span class="va">ncols</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"nrows and ncols must be positive"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">nrows</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">nrows</span><span class="op">)</span> <span class="op">||</span> <span class="va">ncols</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">ncols</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"nrows and ncols must be integers"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="reference/new_table1_blueprint.html">new_table1_blueprint</a></span><span class="op">(</span><span class="va">nrows</span>, <span class="va">ncols</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Validation function for blueprint objects</span></span>
<span><span class="va">validate_table1_blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">cells</span>, <span class="st">"environment"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">cells</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="st">"cells must be an environment or list"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">row_names</span><span class="op">)</span> <span class="op">!=</span> <span class="va">x</span><span class="op">$</span><span class="va">nrows</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="st">"row_names length must match nrows"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">col_names</span><span class="op">)</span> <span class="op">!=</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="st">"col_names length must match ncols"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">errors</span>, <span class="st">"metadata must be a list"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid table1_blueprint object:\n"</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="va">errors</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Enhanced Generic Methods</span></span>
<span><span class="va">print.table1_blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Table1 Blueprint ("</span>, <span class="va">x</span><span class="op">$</span><span class="va">nrows</span>, <span class="st">" x "</span>, <span class="va">x</span><span class="op">$</span><span class="va">ncols</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Formula: "</span>, <span class="fu">deparse_formula</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Theme: "</span>, <span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">theme</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="reference/grapes-or-or-grapes.html">%||%</a></span> <span class="st">"None"</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Populated cells: "</span>, <span class="fu">get_cell_count</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="va">x</span><span class="op">$</span><span class="va">nrows</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">ncols</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">footnote_list</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">footnote_list</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Footnotes: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">footnote_list</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">summary.table1_blueprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Table1 Blueprint Summary\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"========================\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Variable summary</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">x_vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nVariables ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">x_vars</span><span class="op">)</span>, <span class="st">"):\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="va">object</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">x_vars</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Options summary</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">options</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nOptions:\n"</span><span class="op">)</span></span>
<span>    <span class="va">opts</span> <span class="op">&lt;-</span> <span class="va">object</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">options</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">pvalue</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"* P-values:"</span>, <span class="va">opts</span><span class="op">$</span><span class="va">pvalue</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">totals</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"* Totals:"</span>, <span class="va">opts</span><span class="op">$</span><span class="va">totals</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">missing</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"* Missing:"</span>, <span class="va">opts</span><span class="op">$</span><span class="va">missing</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">opts</span><span class="op">$</span><span class="va">strata</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"* Strata:"</span>, <span class="va">opts</span><span class="op">$</span><span class="va">strata</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_6-recommended-file-structure">6. Recommended File Structure<a class="anchor" aria-label="anchor" href="#id_6-recommended-file-structure"></a></h2>
<p><strong>Current Issue:</strong> Single 1,591-line file is unmaintainable.</p>
<p><strong>Optimized Structure:</strong></p>
<pre><code>R/
├── table1.R              # Main user interface (table1 generic)
├── blueprint.R           # Blueprint class and methods
├── cells.R              # Cell types and constructors
├── dimensions.R         # Table dimension analysis
├── validation.R         # Input validation functions
├── evaluation.R         # Cell evaluation and caching
├── themes.R            # Theme system
├── rendering.R         # Output format rendering
├── utils.R             # Helper functions and operators
└── zzz.R              # Package loading hooks

inst/
└── themes/
    ├── nejm.yaml
    ├── lancet.yaml
    └── jama.yaml

tests/
├── testthat/
│   ├── test-blueprint.R
│   ├── test-cells.R
│   ├── test-dimensions.R
│   ├── test-evaluation.R
│   ├── test-themes.R
│   └── test-integration.R
└── test_all.R

vignettes/
├── introduction.Rmd
├── advanced-features.Rmd
└── performance-guide.Rmd</code></pre>
<hr></div>
<div class="section level2">
<h2 id="id_7-implementation-priority-matrix">7. Implementation Priority Matrix<a class="anchor" aria-label="anchor" href="#id_7-implementation-priority-matrix"></a></h2>
<table class="table"><thead><tr><th>Priority</th>
<th>Effort</th>
<th>Impact</th>
<th>Items</th>
</tr></thead><tbody><tr><td><strong>Critical</strong></td>
<td>High</td>
<td>High</td>
<td>Memory optimization, input validation</td>
</tr><tr><td><strong>High</strong></td>
<td>Medium</td>
<td>High</td>
<td>Function decomposition, error handling</td>
</tr><tr><td><strong>Medium</strong></td>
<td>Medium</td>
<td>Medium</td>
<td>Performance improvements, S3 classes</td>
</tr><tr><td><strong>Low</strong></td>
<td>Low</td>
<td>Low</td>
<td>Documentation, code style</td>
</tr></tbody></table><hr></div>
<div class="section level2">
<h2 id="id_8-migration-strategy">8. Migration Strategy<a class="anchor" aria-label="anchor" href="#id_8-migration-strategy"></a></h2>
<div class="section level3">
<h3 id="phase-1-critical-fixes-week-1">Phase 1: Critical Fixes (Week 1)<a class="anchor" aria-label="anchor" href="#phase-1-critical-fixes-week-1"></a></h3>
<ol style="list-style-type: decimal"><li>Implement sparse storage with environment-based cells</li>
<li>Add comprehensive input validation</li>
<li>Split <code>analyze_table_dimensions</code> into focused functions</li>
</ol></div>
<div class="section level3">
<h3 id="phase-2-architecture-week-2-3">Phase 2: Architecture (Week 2-3)<a class="anchor" aria-label="anchor" href="#phase-2-architecture-week-2-3"></a></h3>
<ol style="list-style-type: decimal"><li>Reorganize into modular file structure</li>
<li>Implement proper S3 classes with validation</li>
<li>Enhanced error handling throughout</li>
</ol></div>
<div class="section level3">
<h3 id="phase-3-performance-week-4">Phase 3: Performance (Week 4)<a class="anchor" aria-label="anchor" href="#phase-3-performance-week-4"></a></h3>
<ol style="list-style-type: decimal"><li>Vectorized evaluation implementation</li>
<li>Caching optimization</li>
<li>Optional parallel processing</li>
</ol></div>
<div class="section level3">
<h3 id="phase-4-polish-week-5">Phase 4: Polish (Week 5)<a class="anchor" aria-label="anchor" href="#phase-4-polish-week-5"></a></h3>
<ol style="list-style-type: decimal"><li>Complete test coverage</li>
<li>Documentation improvements</li>
<li>Package structure finalization</li>
</ol><hr></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a></h2>
<p>The zztable1_nextgen codebase demonstrates innovative lazy evaluation architecture but requires significant optimization for production use. The recommended improvements will:</p>
<ul><li>
<strong>Reduce memory usage by 70-90%</strong> through sparse storage</li>
<li>
<strong>Improve performance by 3-5x</strong> through vectorization and caching</li>
<li>
<strong>Enhance maintainability</strong> through modular architecture</li>
<li>
<strong>Increase reliability</strong> through comprehensive validation and error handling</li>
<li>
<strong>Meet modern R standards</strong> through proper S3 classes and best practices</li>
</ul><p>Implementation of these optimizations will transform the codebase from a proof-of-concept into a production-ready package suitable for CRAN submission.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Your Name.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

